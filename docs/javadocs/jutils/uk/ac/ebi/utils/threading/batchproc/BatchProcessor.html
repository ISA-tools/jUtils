<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.2) on Thu Jul 09 13:44:02 UTC 2020 -->
<title>BatchProcessor (JUtils - Core 10.0-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2020-07-09">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BatchProcessor (JUtils - Core 10.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BatchProcessor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">uk.ac.ebi.utils.threading.batchproc</a></div>
<h2 title="Class BatchProcessor" class="title">Class BatchProcessor&lt;B,&#8203;BC extends <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc">BatchCollector</a>&lt;B&gt;,&#8203;BJ extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Consumer</a>&lt;B&gt;&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>uk.ac.ebi.utils.threading.batchproc.BatchProcessor&lt;B,&#8203;BC,&#8203;BJ&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>B</code> - the type of batch to be handled</dd>
<dd><code>BC</code> - the type of <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>BatchCollector</code></a> to use for batch operations</dd>
<dd><code>BJ</code> - the type of job that is able to process a batch of type `B`</dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="ItemizedBatchProcessor.html" title="class in uk.ac.ebi.utils.threading.batchproc">ItemizedBatchProcessor</a></code></dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">BatchProcessor&lt;B,&#8203;BC extends <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc">BatchCollector</a>&lt;B&gt;,&#8203;BJ extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Consumer</a>&lt;B&gt;&gt;</span>
extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">## Batch Processor Skeleton 
 
 A simple skeleton to manage processing of data in multi-thread mode.  
 
 The idea for which this class and <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>batch collectors</code></a> provide scaffolding for
 is that a data source is used to build `B` batches and, when 
 <a href="BatchCollector.html#batchReadyFlag()"><code>a batch is ready to be processed</code></a>, it is submitted to a `BJ`
 job and run in parallel by an <a href="#getExecutor()"><code>getExecutor()</code></a>.   
 
 This class is just a skeleton, for a concrete implementation you need to realise the above source
 processing loop on your own. In order to facilitate that, <a href="#handleNewBatch(B,boolean)"><code>handleNewBatch(Object, boolean)</code></a>
 is provided. You should call it periodically, and it checks if the current batch (that you're filling)
 is ready for submission and, if yes, it submits the current batch to a new parallel job, 
 <a href="BatchCollector.html#batchFactory()"><code>creates a new batch</code></a> and returns it (normally it returns the current
 batch).  
 
 At the end of such a loop, you should call <a href="#waitExecutor(java.lang.String)"><code>waitExecutor(String)</code></a>, so that the final batch you were building
 is forced into processing and other close-up operations are performed.  
 
 As you can see above, <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>BatchCollector</code></a> is another facility to manage batch creation and decide if a
 batch is ready to be processed.   
 
 Specific implementations are provided for both <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>BatchCollector</code></a> and this processor class.
 For instance, We have an <a href="ItemizedBatchProcessor.html" title="class in uk.ac.ebi.utils.threading.batchproc"><code>item-based processor</code></a>, which 
 <code>implements</code> the above-described source dispatching loop
 as the fetch from a stream of items, which are sent to batches.  
 
 This specific processor uses <a href="ItemizedSizedBatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>item-based collectors</code></a>, which of default implementation
 decides if a batch is ready to go on the basis of the <a href="SizedBatchCollector.html#batchSizer()"><code>number of items</code></a>
 it has. Other specific processors are those <a href="processors/CollectionBasedBatchProcessor.html" title="class in uk.ac.ebi.utils.threading.batchproc.processors"><code>based on Java collections</code></a>, which 
 makes use of corresponding <a href="collectors/CollectionBatchCollector.html" title="class in uk.ac.ebi.utils.threading.batchproc.collectors"><code>CollectionBatchCollector</code></a>.  
 
 Note that, while we consider sychronisation issues for the <a href="#getBatchJob()"><code>batch processing jobs</code></a>, we assume that
 the initialisation and submission operations are run by a single thread (eg, `main`), so the code about that isn't 
 thread-safe. For instance, <a href="#waitExecutor(java.lang.String)"><code>waitExecutor(String)</code></a> won't synchronise over the <a href="#getExecutor()"><code>current executor</code></a>
 and <a href="#setBatchJob(BJ)"><code>setBatchJob(Consumer)</code></a> won't synchronise over the current job. Instantiating multiple processors is a 
 safe way to deal with such a multi-multi-thread scenario. Likely, you'll want to share the executor job in such a case.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>brandizi
 <dl><dt>Date:</dt><dd>1 Dec 2017</dd></dl></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#jobLogPeriod">jobLogPeriod</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected org.slf4j.Logger</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#log">log</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">BatchProcessor</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(BJ)">BatchProcessor</a></span>&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;batchJob)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(BJ,BC)">BatchProcessor</a></span>&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;batchJob,
              <a href="BatchProcessor.html" title="type parameter in BatchProcessor">BC</a>&nbsp;batchCollector)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="BatchProcessor.html" title="type parameter in BatchProcessor">BC</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBatchCollector()">getBatchCollector</a></span>()</code></th>
<td class="colLast">
<div class="block">As explained in <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>BatchCollector</code></a>, this is used to create a new batch and decide if it's ready for submission
 to a new <a href="#getBatchJob()"><code>job</code></a>.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBatchJob()">getBatchJob</a></span>()</code></th>
<td class="colLast">
<div class="block"><a href="#handleNewBatch(B,boolean)"><code>handleNewBatch(Object, boolean)</code></a> launches this job every time the current batch being considered is 
 <a href="BatchCollector.html#batchReadyFlag()"><code>ready for processing</code></a>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCompletedBatches()">getCompletedBatches</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">ExecutorService</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getExecutor()">getExecutor</a></span>()</code></th>
<td class="colLast">
<div class="block">The executor service used by <a href="#handleNewBatch(B)"><code>handleNewBatch(Object)</code></a> to submit <a href="#getBatchJob()"><code>batch jobs and 
 run them in parallel</code></a>.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSubmittedBatches()">getSubmittedBatches</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected <a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#handleNewBatch(B)">handleNewBatch</a></span>&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a>&nbsp;currentBatch)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>protected <a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#handleNewBatch(B,boolean)">handleNewBatch</a></span>&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a>&nbsp;currentBatch,
              boolean&nbsp;forceFlush)</code></th>
<td class="colLast">
<div class="block">This is the method that possibly issues a new task, via the <a href="#getExecutor()"><code>getExecutor()</code></a>, which runs 
 the <a href="#getBatchJob()"><code>getBatchJob()</code></a> against the current batch.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setBatchCollector(BC)">setBatchCollector</a></span>&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BC</a>&nbsp;batchCollector)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setBatchJob(BJ)">setBatchJob</a></span>&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;batchJob)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setExecutor(java.util.concurrent.ExecutorService)">setExecutor</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">ExecutorService</a>&nbsp;executor)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setJobLogPeriod(long)">setJobLogPeriod</a></span>&#8203;(long&nbsp;jobLogPeriod)</code></th>
<td class="colLast">
<div class="block">If &gt; 0, methods like <a href="#handleNewBatch(B,boolean)"><code>handleNewBatch(Object, boolean)</code></a> and <a href="#waitExecutor(java.lang.String)"><code>waitExecutor(String)</code></a> log messages 
 about how many submitted and completed <a href="#getBatchJob()"><code>jobs</code></a> the processor is dealing with, and does it every
 a number of submitted jobs equal to this property.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#waitExecutor(java.lang.String)">waitExecutor</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pleaseWaitMessage)</code></th>
<td class="colLast">
<div class="block">Waits that all the parallel jobs submitted to the batchJob are finished.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>protected <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Runnable</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#wrapBatchJob(java.lang.Runnable)">wrapBatchJob</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Runnable</a>&nbsp;batchJob)</code></th>
<td class="colLast">
<div class="block">Wraps the task into some common operations.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="jobLogPeriod">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>jobLogPeriod</h4>
<pre>protected&nbsp;long jobLogPeriod</pre>
</li>
</ul>
<a id="log">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>log</h4>
<pre>protected&nbsp;org.slf4j.Logger log</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(java.util.function.Consumer,uk.ac.ebi.utils.threading.batchproc.BatchCollector)">
<!--   -->
</a><a id="&lt;init&gt;(BJ,BC)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BatchProcessor</h4>
<pre>public&nbsp;BatchProcessor&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;batchJob,
                      <a href="BatchProcessor.html" title="type parameter in BatchProcessor">BC</a>&nbsp;batchCollector)</pre>
</li>
</ul>
<a id="&lt;init&gt;(java.util.function.Consumer)">
<!--   -->
</a><a id="&lt;init&gt;(BJ)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BatchProcessor</h4>
<pre>public&nbsp;BatchProcessor&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;batchJob)</pre>
</li>
</ul>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BatchProcessor</h4>
<pre>public&nbsp;BatchProcessor()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="handleNewBatch(java.lang.Object)">
<!--   -->
</a><a id="handleNewBatch(B)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleNewBatch</h4>
<pre class="methodSignature">protected&nbsp;<a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a>&nbsp;handleNewBatch&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a>&nbsp;currentBatch)</pre>
</li>
</ul>
<a id="handleNewBatch(java.lang.Object,boolean)">
<!--   -->
</a><a id="handleNewBatch(B,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleNewBatch</h4>
<pre class="methodSignature">protected&nbsp;<a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a>&nbsp;handleNewBatch&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">B</a>&nbsp;currentBatch,
                           boolean&nbsp;forceFlush)</pre>
<div class="block">This is the method that possibly issues a new task, via the <a href="#getExecutor()"><code>getExecutor()</code></a>, which runs 
 the <a href="#getBatchJob()"><code>getBatchJob()</code></a> against the current batch. 
 
 Note that the batch job will be executed under the <a href="#wrapBatchJob(java.lang.Runnable)"><code>default wrapper</code></a>.  
 
 This method also resets the internal <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink"><code>ExecutorService</code></a>, which will be recreated (once) upon the first 
 invocation of <a href="#getExecutor()"><code>getExecutor()</code></a>. This behaviour ensures that a processor can be invoked multiple times 
 reusing the same batchJob instance (normally that's not possible for an <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink"><code>ExecutorService</code></a> after its 
 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true#awaitTermination(long,java.util.concurrent.TimeUnit)" title="class or interface in java.util.concurrent" class="externalLink"><code>ExecutorService.awaitTermination(long, TimeUnit)</code></a> method is called).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>forceFlush</code> - if true it flushes the data independently of <a href="BatchCollector.html#batchReadyFlag()"><code>BatchCollector.batchReadyFlag()</code></a>. Which is
 typically needed when you've exhausted a stream of data and you have a last partially-filled batch to process.</dd>
</dl>
</li>
</ul>
<a id="getBatchCollector()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBatchCollector</h4>
<pre class="methodSignature">public&nbsp;<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BC</a>&nbsp;getBatchCollector()</pre>
<div class="block">As explained in <a href="BatchCollector.html" title="interface in uk.ac.ebi.utils.threading.batchproc"><code>BatchCollector</code></a>, this is used to create a new batch and decide if it's ready for submission
 to a new <a href="#getBatchJob()"><code>job</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a id="setBatchCollector(uk.ac.ebi.utils.threading.batchproc.BatchCollector)">
<!--   -->
</a><a id="setBatchCollector(BC)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBatchCollector</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setBatchCollector&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BC</a>&nbsp;batchCollector)</pre>
</li>
</ul>
<a id="getBatchJob()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBatchJob</h4>
<pre class="methodSignature">public&nbsp;<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;getBatchJob()</pre>
<div class="block"><a href="#handleNewBatch(B,boolean)"><code>handleNewBatch(Object, boolean)</code></a> launches this job every time the current batch being considered is 
 <a href="BatchCollector.html#batchReadyFlag()"><code>ready for processing</code></a>.  
 
 Note that your job is wrapped into <a href="#wrapBatchJob(java.lang.Runnable)"><code>wrapBatchJob(Runnable)</code></a>.</div>
</li>
</ul>
<a id="setBatchJob(java.util.function.Consumer)">
<!--   -->
</a><a id="setBatchJob(BJ)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBatchJob</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setBatchJob&#8203;(<a href="BatchProcessor.html" title="type parameter in BatchProcessor">BJ</a>&nbsp;batchJob)</pre>
</li>
</ul>
<a id="getExecutor()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExecutor</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">ExecutorService</a>&nbsp;getExecutor()</pre>
<div class="block">The executor service used by <a href="#handleNewBatch(B)"><code>handleNewBatch(Object)</code></a> to submit <a href="#getBatchJob()"><code>batch jobs and 
 run them in parallel</code></a>.   
 
 By default this is <a href="../HackedBlockingQueue.html#createExecutor()"><code>HackedBlockingQueue.createExecutor()</code></a>, ie, a fixed size executor
 pool, which is able to block and wait when it's full. Moreover, such executor is equipped with a convenient 
 <a href="../ThreadUtils.html#setNamingThreadFactory(java.lang.Class,java.util.concurrent.ThreadPoolExecutor)"><code>naming thread factory</code></a>, which names the 
 threads based on the processor class (ie, myself or one extension of mine).     
 
 Normally you shouldn't need to change this parameter, unless you want some particular execution policy. A 
 situation where you want to use the <a href="#setExecutor(java.util.concurrent.ExecutorService)"><code>setter for this property</code></a> is when 
 you want to hook multiple batch processors to the same executor, to avoid recreating threads too many times, and/or
 to decide an overall thread management policy.</div>
</li>
</ul>
<a id="setExecutor(java.util.concurrent.ExecutorService)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setExecutor</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setExecutor&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">ExecutorService</a>&nbsp;executor)</pre>
</li>
</ul>
<a id="waitExecutor(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitExecutor</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;waitExecutor&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pleaseWaitMessage)</pre>
<div class="block"><p>Waits that all the parallel jobs submitted to the batchJob are finished. It keeps polling
 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true#isTerminated()" title="class or interface in java.util.concurrent" class="externalLink"><code>ExecutorService.isTerminated()</code></a> and invoking <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true#awaitTermination(long,java.util.concurrent.TimeUnit)" title="class or interface in java.util.concurrent" class="externalLink"><code>ExecutorService.awaitTermination(long, TimeUnit)</code></a>.</p>
 
 <p>As explained above, this resets the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ExecutorService.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink"><code>ExecutorService</code></a> that is returned by <a href="#getExecutor()"><code>getExecutor()</code></a>, so that
 the next time that method is invoked, it will get a new executor from <code>#getExecutorFactory()</code>.</p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pleaseWaitMessage</code> - the message to be reported (via logger/INFO level) while waiting.</dd>
</dl>
</li>
</ul>
<a id="wrapBatchJob(java.lang.Runnable)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>wrapBatchJob</h4>
<pre class="methodSignature">protected&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Runnable</a>&nbsp;wrapBatchJob&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Runnable</a>&nbsp;batchJob)</pre>
<div class="block">Wraps the task into some common operations. At the moment,
 
   * wraps exception,
   * logs the progress of completed tasks every <a href="#jobLogPeriod"><code>jobLogPeriod</code></a> completed tasks.</div>
</li>
</ul>
<a id="getSubmittedBatches()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSubmittedBatches</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getSubmittedBatches()</pre>
</li>
</ul>
<a id="getCompletedBatches()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCompletedBatches</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getCompletedBatches()</pre>
</li>
</ul>
<a id="setJobLogPeriod(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setJobLogPeriod</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setJobLogPeriod&#8203;(long&nbsp;jobLogPeriod)</pre>
<div class="block">If &gt; 0, methods like <a href="#handleNewBatch(B,boolean)"><code>handleNewBatch(Object, boolean)</code></a> and <a href="#waitExecutor(java.lang.String)"><code>waitExecutor(String)</code></a> log messages 
 about how many submitted and completed <a href="#getBatchJob()"><code>jobs</code></a> the processor is dealing with, and does it every
 a number of submitted jobs equal to this property. Additionally, <a href="#waitExecutor(java.lang.String)"><code>waitExecutor(String)</code></a> logs the parameter it
 receives.  
 
 If it's 0, just does the latter.  
 
 If it's -1, none of such logging happens.  
 
 It might be useful to disable these messages with 0 or -1 if the caller wants to use its own logging about similar
 events. In particular, it might be useful when you use mukltiple processors in parallel, or the same for multiple
 times.
 
 **WARNING**: implementors of this class's subclasses should comply with the above semantics for this parameter, at 
 least if those classes are general purpose and meant to be reused by third parties.</div>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BatchProcessor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2020. All rights reserved.</small></p>
</footer>
</body>
</html>
